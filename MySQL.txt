CREATE DATABASE IF NOT EXISTS banco_db;
USE banco_db;

CREATE TABLE clientes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100),
    direccion VARCHAR(150),
    tipo ENUM('persona', 'empresa') NOT NULL,
    dni VARCHAR(20),
    cuit VARCHAR(20),
    UNIQUE KEY (dni),
    UNIQUE KEY (cuit)
);

CREATE TABLE telefonos_cliente (
    id INT AUTO_INCREMENT PRIMARY KEY,
    cliente_id INT,
    telefono VARCHAR(20),
    FOREIGN KEY (cliente_id) REFERENCES clientes(id)
);

CREATE TABLE cuentas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    cliente_id INT,
    caja_segura_id INT,
    numero_cuenta VARCHAR(20) UNIQUE,
    saldo DECIMAL(12,2) DEFAULT 0.00,
    tipo ENUM('caja_ahorro', 'cuenta_corriente') NOT NULL,
    limite_descubierto DECIMAL(12,2),
    FOREIGN KEY (caja_segurida_id) REFERENCES
    FOREIGN KEY (cliente_id) REFERENCES clientes(id)
);

CREATE TABLE empleados (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100),
    legajo INT UNIQUE,
    rol ENUM('cajero', 'gerente') NOT NULL
);

CREATE TABLE transacciones (
    id INT AUTO_INCREMENT PRIMARY KEY,
    cuenta_origen_id INT,
    cuenta_destino_id INT,
    monto DECIMAL(12,2),
    tipo ENUM('deposito', 'extraccion', 'transferencia'),
    fecha DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (cuenta_origen_id) REFERENCES cuentas(id),
    FOREIGN KEY (cuenta_destino_id) REFERENCES cuentas(id)
);
